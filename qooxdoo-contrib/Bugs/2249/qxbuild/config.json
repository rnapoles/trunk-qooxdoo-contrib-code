{
  "name" : "qxbuild",

  "include" :
  [
    {
      "path" : "${QOOXDOO_PATH}/tool/data/config/application.json"
    }
  ],

  "let" :
  {
    // ========================================================================
    // [Paths]
    // ========================================================================

    // Qooxdoo instalation directory
    "QOOXDOO_PATH"      : "../../qooxdoo.trunk",

    // If you want UploadWidget, put here correct path
    "UPLOADWIDGET_PATH" : "../qooxdoo-contrib-svn/UploadWidget/trunk",

    // If you want FlowLayout, put here correct path
    "FLOWLAYOUT_PATH"   : "../qooxdoo-contrib-svn/FlowLayout/trunk",

    // If you want TileView, put here correct path
    "TILEVIEW_PATH"     : "../qooxdoo-contrib-svn/TileView/trunk",

    // If you want HtmlArea, put here correct path
    "HTMLAREA_PATH"     : "../qooxdoo-contrib-svn/HtmlArea/0.3-pre",

    // ========================================================================
    // [Internal stuff, do not replace]
    // ========================================================================

    "APPLICATION"       : "qxbuild",

    // ========================================================================
    // [Theme] - should be selected by runtime
    // ========================================================================

    "QXTHEME"           : "qx.theme.Modern",

    // ========================================================================
    // [Other]
    // ========================================================================

    "QXVERSION"         : "0.8.2",
    "LOCALES"           : [ "en" ],
    "ROOT"              : ".",
    "BUILD_PATH"        : "./build",
    "CACHE"             : "cache"
  },
  
  "jobs" :
  {
    // ========================================================================
    // [qxcommon] - inherited by build and debug
    // ========================================================================

    "qxcommon" :
    {
      // ----------------------------------------------------------------------
      // [Library] - What will contain finished build library
      // ----------------------------------------------------------------------

      "library" :
      [
        // [Qooxdoo]
        {
          "manifest" : "${QOOXDOO_PATH}/framework/Manifest.json",
          "uri"      : "${QOOXDOO_URI}"
        }

        // [Contributions, uncomment if you don't want them]

        // [UploadWidget]
        // ,
        // {
        //   "manifest" : "${UPLOADWIDGET_PATH}/Manifest.json",
        //   "uri"      : "${QOOXDOO_URI}"
        // }

        // [FlowLayout]
        // ,
        // {
        //   "manifest" : "${FLOWLAYOUT_PATH}/Manifest.json",
        //   "uri"      : "${QOOXDOO_URI}"
        // }

        // [TileView]
        // ,
        // {
        //   "manifest" : "${TILEVIEW_PATH}/Manifest.json",
        //   "uri"      : "${QOOXDOO_URI}"
        // }

        // [HtmlArea]
        // ,
        // {
        //   "manifest" : "${HTMLAREA_PATH}/Manifest.json",
        //   "uri"      : "${QOOXDOO_URI}"
        // }

        // [User Defined packages]
        // ,
        // {
        //   "manifest" : "./Manifest.json",
        //   "uri"      : "${QOOXDOO_URI}"
        // }
      ],

      // ----------------------------------------------------------------------
      // [Library] - What include in build library
      // ----------------------------------------------------------------------

      "include" :
      [
        "qx.*",
        // "uploadwidget.*",
        // "flowlayout.*",
        // "tileview.*",
        // "htmlarea.*",
        "${QXTHEME}"
      ],

      // ----------------------------------------------------------------------
      // [Library] - What exclude in build library
      // ----------------------------------------------------------------------

      // Always is good to exclude legacy and testing stuff
      "exclude" :
      [
        // Qooxdoo lagacy and testing classes
        "qx.legacy.*"
        ,"qx.test.*"

        // Themes
        // ,"qx.theme.modern.*"

        // List of classes that will be never used (ready for uncomment)
        ,"qx.fx.*"
        // ,"qx.ui.treevirtual.*"
        // ,"qx.ui.progressive.*"

        // Don't include applications in uploadwidget, flow layout and htmlarea
        // ,"uploadwidget.Application"
        // ,"flowlayout.Application"
        // ,"htmlarea.Application"
      ],

      // Where the build cache will be
      "cache" :
      {
        "compile" :  "${CACHE}"
      },

      // Settings in build file, only important, please, everything else can be dynamic
      "settings" :
      {
        "qx.version"     : "${QXVERSION}"
      }
    },

    // ========================================================================
    // [qxbuild-debug] - debug version
    // ========================================================================

    // Job to compile qooxdoo library with debugging informations
    "qxbuild-debug" :
    {
      "extend" : ["qxcommon"],

      "exclude" :
      [
        // Qooxdoo lagacy and testing classes
        "qx.legacy.*"
        ,"qx.test.*"

        // List of classes that will be never used (ready for uncomment)
        // ,"qx.ui.treevirtual.*"
        // ,"qx.ui.progressive.*"

        // Don't include applications
        // ,"uploadwidget.Application"
        // ,"flowlayout.Application"
        // ,"htmlarea.Application"
      ],

      "variants" :
      {
        "qx.debug"    : ["on"],
        "qx.aspects"  : ["on"],
        "qx.dynlocale": ["off"]
      },

      "compile-dist" :
      {
        "paths":
        {
          "file"     : "${BUILD_PATH}/script/qx-debug.js"
        },

        "uris" :
        {
          "script"   : "/QOOXDOO_BUILD_PATH/script",
          "resource" : "/QOOXDOO_BUILD_PATH/resource"
        },

        "code" :
        {
          "format"   : true,
          "locales"  : ["en"],
          "optimize" : []
        }
      }
    },

    // ========================================================================
    // [qxbuild-build] - build version
    // ========================================================================

    // Job to compile optimized qooxdoo library
    "qxbuild-build" :
    {
      "extend" : ["qxcommon"],

      "exclude" :
      [
        // Qooxdoo lagacy and testing classes
        "qx.legacy.*"
        ,"qx.test.*"
        ,"qx.dev.*"

        // Themes
        // ,"qx.theme.modern.*"

        // List of classes that will be never used (ready for uncomment)
        // ,"qx.ui.treevirtual.*"
        // ,"qx.ui.progressive.*"

        // Don't include applications
        // ,"uploadwidget.Application"
        // ,"flowlayout.Application"
        // ,"htmlarea.Application"
      ],

      "variants" :
      {
        "qx.debug"    : ["off"],
        "qx.aspects"  : ["off"],
        "qx.dynlocale": ["off"]
      },

      "compile-dist" :
      {
        "paths":
        {
          "file"     : "${BUILD_PATH}/script/qx-build.js"
        },

        "uris" :
        {
          "script"   : "/QOOXDOO_BUILD_PATH/script",
          "resource" : "/QOOXDOO_BUILD_PATH/resource"
        },

        "code" :
        {
          "format"   : false,
          "locales"  : ["en"],
          "optimize" : ["variables", "basecalls", "privates", "strings"]
        }
      }
    },

    // ========================================================================
    // [qxbuild-resources] - resources
    // ========================================================================

    // Job to compile qooxdoo resources
    "qxbuild-resources" :
    {
      "extend" : ["qxcommon"],

      "copy-resources" :
      {
        "target"          : "${BUILD_PATH}",
        "resource-filter" : true
      }
    },
    
    "qxbuild-fix" :
    {
      "shell": 
      {
        "command": "./fix.py"
      }
    },

    // ========================================================================
    // [compile-qx] - compile all (called from command line)
    // ========================================================================

    // Job to compile all (resources, debug and build)
    "compile-qx" :
    {
      "run" :
      [
        "qxbuild-resources",
        "qxbuild-debug",
        "qxbuild-build",
        "qxbuild-fix"
      ]
    }
  }
}
