<?xml version="1.0" encoding="utf-8"?>
<qxt:component
  xmlns:qx="http://www.qxtransformer.org/qooxdoo/0.8"
  xmlns:qxt="http://www.qxtransformer.org/extension/0.4"
  xmlns:qcl="http://www.qooxdoo.org/contrib/qcl/trunk"
  author="Christian Boulanger"
  className="access.components.ToolBar"
  tagName="toolBar">

  <qx:toolBar>
  
    <qx:toolBarPart>

      <qx:toolBarButton 
        label="Login" icon="icon/16/status/dialog-password.png"
        visibility="excluded">
        
        <!-- show button only when user is not logged in -->
        <qcl:observe 
          property="visibility" 
          source="this.getApplication().getUserManager()"
          sourceProp="activeUser.username"
          converter="function(username){ return username=='anonymous' ? 'visible' : 'excluded' }" />
          
        <qxt:listener type="execute">
          qcl.components.login.Popup.getInstance().show();
        </qxt:listener>
        
      </qx:toolBarButton>

      <qx:toolBarButton 
        label="Logout" icon="icon/16/actions/application-exit.png"
        visibility="excluded">
        
        <!-- show button only when user is logged in -->
        <qcl:observe 
          property="visibility" 
          source="this.getApplication().getUserManager()"
          sourceProp="activeUser.username"
          converter="function(username){ return username!='anonymous' ? 'visible' : 'excluded' }" />
          
        <qxt:listener type="execute">
          this.getApplication().logout();
          qcl.components.login.Popup.getInstance().show();
        </qxt:listener>
        
      </qx:toolBarButton>

      <qx:atom 
        label="Loading..." 
        icon="icon/22/apps/preferences-users.png">
      
        <qcl:observe 
          property="label" 
          source="this.getApplication().getUserManager()"
          sourceProp="activeUser.fullname" />
      
      </qx:atom>
    </qx:toolBarPart>

  </qx:toolBar>
  
</qxt:component>