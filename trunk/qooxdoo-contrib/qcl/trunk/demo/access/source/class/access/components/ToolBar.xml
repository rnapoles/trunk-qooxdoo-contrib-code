<?xml version="1.0" encoding="utf-8"?>
<qxt:component
  xmlns:qx="http://www.qxtransformer.org/qooxdoo/0.8"
  xmlns:qxt="http://www.qxtransformer.org/extension/0.4"
  xmlns:qcl="http://www.qooxdoo.org/contrib/qcl/trunk"
  author="Christian Boulanger"
  className="access.components.ToolBar"
  tagName="toolBar">

  <qx:toolBar>
  
    <qx:toolBarPart>

      <qx:toolBarButton 
        id="loginButton"      
        label="Login" icon="icon/16/status/dialog-password.png"
        visibility="excluded">
        
        <!-- show button only when user is not logged in -->
        <qxt:observe 
          path="visibility" 
          source="this.getApplication()"
          sourcePath="authenticatedUser"
          converter="function(v){v?'excluded':'visible'}" />
          
        <!-- show login popup on button click -->          
        <qxt:listener type="execute">
          this.getApplication().getAppManager().getWidgetById("loginPopup").show();
        </qxt:listener>
        
      </qx:toolBarButton>

      <qx:toolBarButton 
        id="logoutButton"
        label="Logout" icon="icon/16/actions/application-exit.png"
        visibility="excluded">
        
        <!-- show button only when other button is not visible and the other way round -->
        <qxt:observe 
          path="visibility" 
          source="loginButton"
          sourcePath="visibility"
          converter="function(visibility){ return ( visibility == 'visible' ) ? 'excluded' : 'visible' }" />
          
        <!-- logout user on button click -->
        <qxt:listener type="execute">
          this.getApplication().getAppManager().logoutUser();
        </qxt:listener>
        
      </qx:toolBarButton>

      <qx:atom 
        label="Loading..." 
        icon="icon/22/apps/preferences-users.png">
      
        <qxt:observe 
          path="label" 
          source="this.getApplication()"
          sourcePath="appManager.userManager.activeUser.fullname" />
      
      </qx:atom>
    </qx:toolBarPart>
    
    <qx:toolBarPart>

      <qx:toolBarMenuButton label="Server" >
        <qx:menu>
          <qx:radioGroup>
            <qx:menuRadioButton label="Use RpcPhp server" model="qcl"/>
            <qx:menuRadioButton label="Use qcl server" model="qcl"/>
            <qxt:bind 
              path="selection[0].model" 
              target="this.application()"
              targetPath="server"
             />
          </qx:radioGroup>
        </qx:menu>
      </qx:toolBarMenuButton>
      
   </qx:toolBarPart>  
  </qx:toolBar>
  
</qxt:component>